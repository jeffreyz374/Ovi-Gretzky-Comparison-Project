}
paste0(text,
"'</table></div>'
return text;};"
)
}
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Period <- case_when(ovi_data_copy$Period == 1 ~ "1st", ovi_data_copy$Period == 2 ~ "2nd", ovi_data_copy$Period == 3 ~ "3rd", ovi_data_copy$Period == "OT" ~ "Overtime")
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
ovi_data_copy$cgoal <- rev(c(1:nrow(ovi_data_copy)))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data
gretzky_data_copy[is.na(gretzky_data_copy)] <- "N/A"
gretzky_data_copy$PS <- case_when(gretzky_data_copy$PS == 0 ~ "No", gretzky_data_copy$PS == 1 ~ "Yes")
gretzky_data_copy$ENG <- case_when(gretzky_data_copy$ENG == 0 ~ "No", gretzky_data_copy$ENG == 1 ~ "Yes")
gretzky_data_copy$Result <- case_when(gretzky_data_copy$Result == "W" ~ "Regulation Win",
gretzky_data_copy$Result == "L" ~ "Regulation Loss",
gretzky_data_copy$Result == "OTW" ~ "Overtime Win",
gretzky_data_copy$Result == "OTL" ~ "Overtime Loss",
gretzky_data_copy$Result == "T" ~ "Tie")
gretzky_data_copy$HomeAway <- case_when(gretzky_data_copy$HomeAway == "H" ~ "Home", gretzky_data_copy$HomeAway == "A" ~ "Away")
gretzky_data_copy$Strength <- case_when(gretzky_data_copy$Strength == "EV" ~ "Even Strength", gretzky_data_copy$Strength == "PP" ~ "Power Play", gretzky_data_copy$Strength == "SH" ~ "Shorthanded")
gretzky_data_copy$Time <- substr(gretzky_data_copy$Time, start = 12, stop = 16)
gretzky_data_copy$Period <- case_when(gretzky_data_copy$Period == 1 ~ "1st", gretzky_data_copy$Period == 2 ~ "2nd", gretzky_data_copy$Period == 3 ~ "3rd", gretzky_data_copy$Period == "OT" ~ "Overtime")
gretzky_data_copy$Team <- case_when(gretzky_data_copy$Team == "EDM" ~ "Edmonton Oilers",
gretzky_data_copy$Team == "LAK" ~ "Los Angeles Kings",
gretzky_data_copy$Team == "STL" ~ "St. Louis Blues",
gretzky_data_copy$Team == "NYR" ~ "New York Rangers")
gretzky_data_copy <- merge(gretzky_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
gretzky_data_copy <- gretzky_data_copy[c(2:ncol(gretzky_data_copy))]
colnames(gretzky_data_copy) <- c("Date", "Team", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Result", "Home/Away", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
gretzky_data_copy <- gretzky_data_copy[, c(1, 2, 15, 3:10, 12, 11, 13, 14)]
gretzky_data_copy <- left_join(gretzky_data_copy, gretzky_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
gretzky_data_copy <- gretzky_data_copy[, c(1:13, 18, 14:15)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
gretzky_data_copy$cgoal <- rev(c(1:894))
gretzky_data_copy <- gretzky_data_copy[, c(1:4, 17, 5:16)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_goal_wins <- ovi_data_copy %>%
select(c("Date", "Result")) %>%
distinct(Date, Result) %>%
group_by(Result) %>%
summarise(Frequency = n())
gretzky_goal_wins <- gretzky_data_copy %>%
select(c("Date", "Result")) %>%
distinct(Date, Result) %>%
group_by(Result) %>%
summarise(Frequency = n())
ovi_goal_wins <- ovi_goal_wins %>%
ggplot(aes(x = Result, y = Frequency)) +
geom_bar(stat = "identity", fill = "red") +
ggtitle("Frequencies of different game outcomes for Ovechkin's team \n when Ovechkin scores at least one goal") +
scale_x_discrete(limits = c("Regulation Win", "Overtime Win", "Shootout Win",
"Shootout Loss", "Overtime Loss", "Regulation Loss")) +
theme_minimal()
gretzky_goal_wins <- gretzky_goal_wins %>%
ggplot(aes(x = Result, y = Frequency)) +
geom_bar(stat = "identity", fill = "blue") +
ggtitle("Frequencies of different game outcomes for Gretzky's team \n when Gretzky scores at least one goal") +
scale_x_discrete(limits = c("Regulation Win", "Overtime Win", "Tie",
"Overtime Loss", "Regulation Loss")) +
theme_minimal()
ggplotly(ovi_goal_wins) %>%
layout(hoverlabel=list(bgcolor="white"))
ggplotly(gretzky_goal_wins) %>%
layout(hoverlabel=list(bgcolor="white"))
missing_ovi_games <- ovi_potential_games %>%
filter(Date %in% setdiff(ovi_potential_games$Date, x_ovi$Date))
missing_gretzky_games <- gretzky_potential_games %>%
filter(Date %in% setdiff(gretzky_potential_games$Date, x_gretzky$Date))
ovi_nogoal_wins <- missing_ovi_games %>%
mutate(Result = case_when(Result == "W" ~ "Regulation Win",
Result == "OTW" ~ "Overtime Win",
Result == "SOW" ~ "Shootout Win",
Result == "SOL" ~ "Shootout Loss",
Result == "OTL" ~ "Overtime Loss",
Result == "L" ~ "Regulation Loss")) %>%
group_by(Result) %>%
summarise(Frequency = n())
gretzky_nogoal_wins <- missing_gretzky_games %>%
mutate(Result = case_when(Result == "W" ~ "Regulation Win",
Result == "OTW" ~ "Overtime Win",
Result == "T" ~ "Tie",
Result == "OTL" ~ "Overtime Loss",
Result == "L" ~ "Regulation Loss")) %>%
group_by(Result) %>%
summarise(Frequency = n())
ovi_nogoal_wins <- ovi_nogoal_wins %>%
ggplot(aes(x = Result, y = Frequency)) +
geom_bar(stat = "identity", fill = "red") +
ggtitle("Frequencies of different game outcomes for Ovechkin's team \n when Ovechkin DOES NOT score a goal") +
scale_x_discrete(limits = c("Regulation Win", "Overtime Win", "Shootout Win",
"Shootout Loss", "Overtime Loss", "Regulation Loss")) +
theme_minimal()
gretzky_nogoal_wins <- gretzky_nogoal_wins %>%
ggplot(aes(x = Result, y = Frequency)) +
geom_bar(stat = "identity", fill = "blue") +
ggtitle("Frequencies of different game outcomes for Gretzky's team \n when Gretzky DOES NOT score a goal") +
scale_x_discrete(limits = c("Regulation Win", "Overtime Win", "Tie",
"Overtime Loss", "Regulation Loss")) +
theme_minimal()
ggplotly(ovi_nogoal_wins) %>%
layout(hoverlabel=list(bgcolor="white"))
ggplotly(gretzky_nogoal_wins) %>%
layout(hoverlabel=list(bgcolor="white"))
datatable2(x = ovi_data_copy, vars = colnames(ovi_data_copy)[-c(1, 2, 3, 5)])
datatable2(x = gretzky_data_copy, vars = colnames(gretzky_data_copy)[-c(1, 2, 3, 5)])
library(data.table)
library(tidyverse)
library(dplyr)
library(plotly)
library(DT)
library(knitr)
library(RCurl)
# Initialize code chunk options
opts_chunk$set(
warning = FALSE,
message = FALSE,
eval=TRUE,
echo = TRUE,
cache = FALSE,
fig.width = 7,
fig.align = 'center',
fig.asp = 0.618,
out.width = "700px",
class.source = "code-r")
ovi_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-data.csv")
ovi_data <- read.csv(text = ovi_data)
gretzky_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-data.csv")
gretzky_data <- read.csv(text = gretzky_data)
ovi_goals_by_date <- ovi_data %>%
group_by(Date) %>%
summarise(Goals = n())
unique_date_opponent_pairs <- ovi_data %>%
select(c("Date", "Opponent")) %>%
distinct(Date, Opponent)
ovi_goals_by_date <- merge(ovi_goals_by_date, unique_date_opponent_pairs)
caps_wins_by_date <- ovi_data %>%
distinct(Date, Result)
x_ovi <- merge(ovi_goals_by_date, caps_wins_by_date)
gretzky_goals_by_date <- gretzky_data %>%
group_by(Date) %>%
summarise(Goals = n())
wins_by_date <- gretzky_data %>%
distinct(Date, Result)
x_gretzky <- merge(gretzky_goals_by_date, wins_by_date)
ovi_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-potential-games.csv")
ovi_potential_games <- read.csv(text = ovi_potential_games)
gretzky_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-potential-games.csv")
gretzky_potential_games <- read.csv(text = gretzky_potential_games)
name_table <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/name-table.csv")
name_table <- read.csv(text = name_table)
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Period <- case_when(ovi_data_copy$Period == 1 ~ "1st", ovi_data_copy$Period == 2 ~ "2nd", ovi_data_copy$Period == 3 ~ "3rd", ovi_data_copy$Period == "OT" ~ "Overtime")
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
ovi_data_copy$cgoal <- rev(c(1:nrow(ovi_data_copy)))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data
gretzky_data_copy[is.na(gretzky_data_copy)] <- "N/A"
gretzky_data_copy$PS <- case_when(gretzky_data_copy$PS == 0 ~ "No", gretzky_data_copy$PS == 1 ~ "Yes")
gretzky_data_copy$ENG <- case_when(gretzky_data_copy$ENG == 0 ~ "No", gretzky_data_copy$ENG == 1 ~ "Yes")
gretzky_data_copy$Result <- case_when(gretzky_data_copy$Result == "W" ~ "Regulation Win",
gretzky_data_copy$Result == "L" ~ "Regulation Loss",
gretzky_data_copy$Result == "OTW" ~ "Overtime Win",
gretzky_data_copy$Result == "OTL" ~ "Overtime Loss",
gretzky_data_copy$Result == "T" ~ "Tie")
gretzky_data_copy$HomeAway <- case_when(gretzky_data_copy$HomeAway == "H" ~ "Home", gretzky_data_copy$HomeAway == "A" ~ "Away")
gretzky_data_copy$Strength <- case_when(gretzky_data_copy$Strength == "EV" ~ "Even Strength", gretzky_data_copy$Strength == "PP" ~ "Power Play", gretzky_data_copy$Strength == "SH" ~ "Shorthanded")
gretzky_data_copy$Time <- substr(gretzky_data_copy$Time, start = 12, stop = 16)
gretzky_data_copy$Period <- case_when(gretzky_data_copy$Period == 1 ~ "1st", gretzky_data_copy$Period == 2 ~ "2nd", gretzky_data_copy$Period == 3 ~ "3rd", gretzky_data_copy$Period == "OT" ~ "Overtime")
gretzky_data_copy$Team <- case_when(gretzky_data_copy$Team == "EDM" ~ "Edmonton Oilers",
gretzky_data_copy$Team == "LAK" ~ "Los Angeles Kings",
gretzky_data_copy$Team == "STL" ~ "St. Louis Blues",
gretzky_data_copy$Team == "NYR" ~ "New York Rangers")
gretzky_data_copy <- merge(gretzky_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
gretzky_data_copy <- gretzky_data_copy[c(2:ncol(gretzky_data_copy))]
colnames(gretzky_data_copy) <- c("Date", "Team", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Result", "Home/Away", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
gretzky_data_copy <- gretzky_data_copy[, c(1, 2, 15, 3:10, 12, 11, 13, 14)]
gretzky_data_copy <- left_join(gretzky_data_copy, gretzky_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
gretzky_data_copy <- gretzky_data_copy[, c(1:13, 18, 14:15)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
gretzky_data_copy$cgoal <- rev(c(1:894))
gretzky_data_copy <- gretzky_data_copy[, c(1:4, 17, 5:16)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_season_stats <- ovi_data %>%
mutate(Season = case_when(Date >= "2005-10-01" & Date <= "2006-06-01" ~ "2005-06",
Date >= "2006-10-01" & Date <= "2007-06-01" ~ "2006-07",
Date >= "2007-10-01" & Date <= "2008-06-01" ~ "2007-08",
Date >= "2008-10-01" & Date <= "2009-06-01" ~ "2008-09",
Date >= "2009-10-01" & Date <= "2010-06-01" ~ "2009-10",
Date >= "2010-10-01" & Date <= "2011-06-01" ~ "2010-11",
Date >= "2011-10-01" & Date <= "2012-06-01" ~ "2011-12",
Date >= "2012-10-01" & Date <= "2013-06-01" ~ "2012-13",
Date >= "2013-10-01" & Date <= "2014-06-01" ~ "2013-14",
Date >= "2014-10-01" & Date <= "2015-06-01" ~ "2014-15",
Date >= "2015-10-01" & Date <= "2016-06-01" ~ "2015-16",
Date >= "2016-10-01" & Date <= "2017-06-01" ~ "2016-17",
Date >= "2017-10-01" & Date <= "2018-06-01" ~ "2017-18",
Date >= "2018-10-01" & Date <= "2019-06-01" ~ "2018-19",
Date >= "2019-10-01" & Date <= "2020-06-01" ~ "2019-20",
Date >= "2020-10-01" & Date <= "2021-06-01" ~ "2020-21",
Date >= "2021-10-01" & Date <= "2022-06-01" ~ "2021-22",
Date >= "2022-10-01" & Date <= "2023-06-01" ~ "2022-23",
Date >= "2023-10-01" & Date <= "2024-06-01" ~ "2023-24",
Date >= "2024-10-01" & Date <= "2025-06-01" ~ "2024-25"))
ovi_season_goals <- ovi_season_stats %>%
group_by(Season) %>%
summarise(Goals = n()) %>%
ggplot(aes(x = Season, Goals)) +
geom_bar(stat = "identity", fill = "red") +
ylab("Goals") +
ggtitle("Number of goals scored by Ovechkin at varying seasons in his NHL career") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
# ovi_season_engs <- ovi_season_stats %>%
#   group_by(Season) %>%
#   summarise(ENGs = sum(ENG),
#             NonENGs = n() - ENGs) %>%
#   pivot_longer(-Season) %>%
#   ggplot(aes(x = Season, y = value, fill = name)) +
#   geom_col(position = position_stack()) +
#   theme_minimal() +
#   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
gretzky_season_stats <- gretzky_data %>%
mutate(Season = case_when(Date >= "1979-10-01" & Date <= "1980-06-01" ~ "1979-80",
Date >= "1980-10-01" & Date <= "1981-06-01" ~ "1980-81",
Date >= "1981-10-01" & Date <= "1982-06-01" ~ "1981-82",
Date >= "1982-10-01" & Date <= "1983-06-01" ~ "1982-83",
Date >= "1983-10-01" & Date <= "1984-06-01" ~ "1983-84",
Date >= "1984-10-01" & Date <= "1985-06-01" ~ "1984-85",
Date >= "1985-10-01" & Date <= "1986-06-01" ~ "1985-86",
Date >= "1986-10-01" & Date <= "1987-06-01" ~ "1986-87",
Date >= "1987-10-01" & Date <= "1988-06-01" ~ "1987-88",
Date >= "1988-10-01" & Date <= "1989-06-01" ~ "1988-89",
Date >= "1989-10-01" & Date <= "1990-06-01" ~ "1989-90",
Date >= "1990-10-01" & Date <= "1991-06-01" ~ "1990-91",
Date >= "1991-10-01" & Date <= "1992-06-01" ~ "1991-92",
Date >= "1992-10-01" & Date <= "1993-06-01" ~ "1992-93",
Date >= "1993-10-01" & Date <= "1994-06-01" ~ "1993-94",
Date >= "1994-10-01" & Date <= "1995-06-01" ~ "1994-95",
Date >= "1995-10-01" & Date <= "1996-06-01" ~ "1995-96",
Date >= "1996-10-01" & Date <= "1997-06-01" ~ "1996-97",
Date >= "1997-10-01" & Date <= "1998-06-01" ~ "1997-98",
Date >= "1998-10-01" & Date <= "1999-06-01" ~ "1998-99"))
gretzky_season_goals <- gretzky_season_stats %>%
group_by(Season) %>%
summarise(Goals = n()) %>%
ggplot(aes(x = Season, Goals)) +
geom_bar(stat = "identity", fill = "blue") +
ylab("Goals") +
ggtitle("Number of goals scored by Gretzky at varying seasons in his NHL career") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
# gretzky_season_engs <- gretzky_season_stats %>%
#   group_by(Season) %>%
#   summarise(ENGs = sum(ENG),
#             NonENGs = n() - ENGs) %>%
#   pivot_longer(-Season) %>%
#   ggplot(aes(x = Season, y = value, fill = name)) +
#   geom_col(position = position_stack()) +
#   theme_minimal() +
#   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
ggplotly(ovi_season_goals) %>%
layout(hoverlabel=list(bgcolor="white"))
ggplotly(gretzky_season_goals) %>%
layout(hoverlabel=list(bgcolor="white"))
gretzky_age_stats <- gretzky_data %>%
group_by(Age) %>%
summarise(Goals = n())
ovi_age_stats <- ovi_data %>%
group_by(Age) %>%
summarise(Goals = n())
ovi_age_goals <- ovi_age_stats %>%
ggplot(aes(x = Age, Goals)) +
geom_bar(stat = "identity", fill = "red") +
ylab("Goals") +
ggtitle("Number of goals scored by Ovechkin at varying ages in his NHL career") +
theme_minimal()
gretzky_age_goals <- gretzky_age_stats %>%
ggplot(aes(x = Age, Goals)) +
geom_bar(stat = "identity", fill = "blue") +
ylab("Goals") +
ggtitle("Number of goals scored by Gretzky at varying ages in his NHL career") +
theme_minimal()
age_joint <- left_join(gretzky_age_stats, ovi_age_stats, by = "Age") %>%
rename(Gretzky = Goals.x, Ovechkin = Goals.y)
age_joint[is.na(age_joint)] <- 0
ovi_gretzky_age_joint <- age_joint %>%
gather(Player, Goals, -Age) %>%
ggplot(aes(x = Age, y = Goals, fill = Player)) +
scale_fill_manual(values = c("blue", "red")) +
geom_col(position = "dodge") +
ylab("Goals") +
ggtitle("Comparison of the number of goals scored by both \n Ovechkin and Gretzky at varying ages in their NHL careers") +
theme_minimal()
ggplotly(ovi_age_goals) %>%
layout(hoverlabel=list(bgcolor="white"))
ggplotly(gretzky_age_goals) %>%
layout(hoverlabel=list(bgcolor="white"))
ggplotly(ovi_gretzky_age_joint)%>%
layout(hoverlabel=list(bgcolor="white"))
gretzky_opponent_stats <- gretzky_data_copy %>%
group_by(Opponent) %>%
summarise(Goals = n())
ovi_opponent_stats <- ovi_data_copy %>%
group_by(Opponent) %>%
summarise(Goals = n())
ovi_opponent_goals <- ovi_opponent_stats %>%
ggplot(aes(x = reorder(Opponent, Goals), y = Goals, text = paste("Opponent: ", Opponent, '\nGoals: ', Goals))) +
geom_bar(stat = "identity", fill = "red") +
ylab("Goals") +
xlab("Opponent") +
ggtitle("Number of goals scored by Ovechkin against \n varying opponents in his NHL career") +
theme_minimal() +
coord_flip()
gretzky_opponent_goals <- gretzky_opponent_stats %>%
ggplot(aes(x = reorder(Opponent, Goals), y = Goals, text = paste("Opponent: ", Opponent, '\nGoals: ', Goals))) +
geom_bar(stat = "identity", fill = "blue") +
ylab("Goals") +
xlab("Opponent") +
ggtitle("Number of goals scored by Gretzky against \n varying opponents in his NHL career") +
theme_minimal() +
coord_flip()
ggplotly(ovi_opponent_goals, tooltip = c("text")) %>%
layout(autosize = F, height = 450, hoverlabel=list(bgcolor="white"))
ggplotly(gretzky_opponent_goals, tooltip = c("text")) %>%
layout(autosize = F, height = 450, hoverlabel=list(bgcolor="white"))
ovi_goalies <- ovi_data %>%
mutate(Goalie = replace(Goalie, is.na(Goalie), "Empty Net")) %>%
group_by(Goalie) %>%
summarise(Goals = n())
gretzky_goalies <- gretzky_data %>%
mutate(Goalie = replace(Goalie, is.na(Goalie), "Empty Net")) %>%
group_by(Goalie) %>%
summarise(Goals = n())
ovi_goalies_plot <- ovi_goalies %>%
ggplot(aes(x = reorder(Goalie, Goals), y = Goals, text = paste("Goalie: ", Goalie, '\nGoals: ', Goals))) +
geom_bar(stat = "identity", fill = "red") +
ylab("Goals") +
xlab("Goalie") +
ggtitle("Number of goals scored on various goalies by \n Ovechkin in his NHL career") +
theme_minimal() +
coord_flip()
gretzky_goalies_plot <- gretzky_goalies %>%
ggplot(aes(x = reorder(Goalie, Goals), y = Goals, text = paste("Goalie: ", Goalie, '\nGoals: ', Goals))) +
geom_bar(stat = "identity", fill = "blue") +
ylab("Goals") +
xlab("Goalie") +
ggtitle("Number of goals scored on various goalies by \n Gretzky in his NHL career") +
theme_minimal() +
coord_flip()
ggplotly(ovi_goalies_plot, tooltip = c("text")) %>%
layout(autosize = F, height = 2000, hoverlabel=list(bgcolor="white"))
ggplotly(gretzky_goalies_plot, tooltip = c("text")) %>%
layout(autosize = F, height = 2000, hoverlabel=list(bgcolor="white"))
merge(ovi_season_stats %>% group_by(Season) %>% summarise(ENGs = sum(ENG)), ovi_season_stats %>% group_by(Season) %>% summarise(Goals = n())) %>% transform(ENGpercent = 100 * ENGs / Goals)
merge(gretzky_season_stats %>% group_by(Season) %>% summarise(ENGs = sum(ENG)), gretzky_season_stats %>% group_by(Season) %>% summarise(Goals = n())) %>% transform(ENGpercent = 100 * ENGs / Goals)
merge(ovi_season_stats %>% group_by(Season) %>% summarise(ENGs = sum(ENG)), ovi_season_stats %>% group_by(Season) %>% summarise(Goals = n())) %>% transform(ENGpercent = 100 * ENGs / Goals)
ovi_season_stats %>% group_by(Date) %>% summarise(n = n())
View(ovi_season_stats)
ovi_season_stats %>% group_by(Date, Opponent) %>% summarise(n = n())
print(n = 50)
ovi_season_stats %>% group_by(Date, Opponent) %>% summarise(n = n()) %>% print(n = 50)
ovi_season_stats %>% group_by(Date, Opponent) %>% summarise(n = n()) %>% filter(n >= 2)
unique((ovi_season_stats %>% group_by(Date, Opponent) %>% summarise(n = n()) %>% filter(n >= 2))$Opponent)
sort(unique((ovi_season_stats %>% group_by(Date, Opponent) %>% summarise(n = n()) %>% filter(n >= 2))$Opponent))
ovi_season_stats %>% group_by(Opponent) %>% summarise(ENGs = sum(ENG))
ovi_season_stats %>% group_by(Opponent) %>% summarise(ENGs = sum(ENG)) %>% print(n = 40)
View(ovi_potential_games)
library(data.table)
library(tidyverse)
library(dplyr)
library(plotly)
library(DT)
library(knitr)
library(RCurl)
# Initialize code chunk options
opts_chunk$set(
warning = FALSE,
message = FALSE,
eval=TRUE,
echo = TRUE,
cache = FALSE,
fig.width = 7,
fig.align = 'center',
fig.asp = 0.618,
out.width = "700px",
class.source = "code-r")
ovi_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-data.csv")
ovi_data <- read.csv(text = ovi_data)
gretzky_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-data.csv")
gretzky_data <- read.csv(text = gretzky_data)
ovi_goals_by_date <- ovi_data %>%
group_by(Date) %>%
summarise(Goals = n())
unique_date_opponent_pairs <- ovi_data %>%
select(c("Date", "Opponent")) %>%
distinct(Date, Opponent)
ovi_goals_by_date <- merge(ovi_goals_by_date, unique_date_opponent_pairs)
caps_wins_by_date <- ovi_data %>%
distinct(Date, Result)
x_ovi <- merge(ovi_goals_by_date, caps_wins_by_date)
gretzky_goals_by_date <- gretzky_data %>%
group_by(Date) %>%
summarise(Goals = n())
wins_by_date <- gretzky_data %>%
distinct(Date, Result)
x_gretzky <- merge(gretzky_goals_by_date, wins_by_date)
ovi_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-potential-games.csv")
ovi_potential_games <- read.csv(text = ovi_potential_games)
gretzky_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-potential-games.csv")
gretzky_potential_games <- read.csv(text = gretzky_potential_games)
name_table <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/name-table.csv")
name_table <- read.csv(text = name_table)
library(data.table)
library(tidyverse)
library(dplyr)
library(plotly)
library(DT)
library(knitr)
library(RCurl)
# Initialize code chunk options
opts_chunk$set(
warning = FALSE,
message = FALSE,
eval=TRUE,
echo = TRUE,
cache = FALSE,
fig.width = 7,
fig.align = 'center',
fig.asp = 0.618,
out.width = "700px",
class.source = "code-r")
ovi_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-data.csv")
ovi_data <- read.csv(text = ovi_data)
gretzky_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-data.csv")
gretzky_data <- read.csv(text = gretzky_data)
ovi_goals_by_date <- ovi_data %>%
group_by(Date) %>%
summarise(Goals = n())
unique_date_opponent_pairs <- ovi_data %>%
select(c("Date", "Opponent")) %>%
distinct(Date, Opponent)
ovi_goals_by_date <- merge(ovi_goals_by_date, unique_date_opponent_pairs)
caps_wins_by_date <- ovi_data %>%
distinct(Date, Result)
x_ovi <- merge(ovi_goals_by_date, caps_wins_by_date)
gretzky_goals_by_date <- gretzky_data %>%
group_by(Date) %>%
summarise(Goals = n())
wins_by_date <- gretzky_data %>%
distinct(Date, Result)
x_gretzky <- merge(gretzky_goals_by_date, wins_by_date)
ovi_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-potential-games.csv")
ovi_potential_games <- read.csv(text = ovi_potential_games)
gretzky_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-potential-games.csv")
gretzky_potential_games <- read.csv(text = gretzky_potential_games)
name_table <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/name-table.csv")
name_table <- read.csv(text = name_table)
View(ovi_data)
